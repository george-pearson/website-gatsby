<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.94417129a3454f6452ff.css">.style-module--hexagonalLatticeExample--19TsT{stroke-width:3;display:block;margin:0 auto}.style-module--circlesExample--3MMKq,.style-module--linesExample--Ogm8H{stroke-width:3;stroke:#930;display:block;margin:0 auto}.style-module--circlesExample--3MMKq{fill:None}.common-module--halfWidthContainer--1O3jv{display:grid;grid-template-columns:1fr 1fr}.common-module--halfWidthLeft--YeN8C{grid-column:1/span 1;padding-right:1em}.common-module--halfWidthRight--IjbdE{grid-column:2/span 1;padding-left:1em}@media (max-width:46rem){.common-module--halfWidthLeft--YeN8C,.common-module--halfWidthRight--IjbdE{grid-column:1/span 2;justify-self:center;padding-right:0;padding-left:0}}.style-module--displayBlock--iPhpg{display:block}.style-module--displayHidden--21VAm{display:none}.style-module--container--3pYZP{overflow-x:scroll}.style-module--controls--1ld-o{margin:.5rem 0}.style-module--displayHidden--2K05X{display:none}.style-module--saturation--1RogJ{padding:1rem 0}.style-module--colourWheel--2-rSW{margin:auto;display:block}.style-module--displayNone--2rZ5S{display:none}.style-module--dislayBlock--3OXtv{display:block}.style-module--controlGroup--1sL_L{padding:.5rem 0}.style-module--control--fRXxc{margin:.25rem}.style-module--container--1QUVW{overflow-x:scroll}.style-module--controls--1y8XI{padding-top:.5rem}.style-module--control--vLe4q{margin:.25rem}.style-module--displayBlock--2BDsS{display:block}.style-module--displayHidden--1cmzY{display:none}.style-module--container--2QO0X{overflow-x:scroll}.style-module--controls--2oYnC{padding-top:.5rem}.style-module--inputControl--2oZfe{margin:0 .5rem}.style-module--logoDrawself--3MgBP{max-width:400px;max-height:400px;width:100%;height:100%;display:block;margin:auto}.style-module--coffeeDashedOff--2PfJ5,.style-module--coffeeDashedOn--10CU2{max-width:250px;max-height:375px;width:100%;height:100%}.style-module--coffeeDashedOff--2PfJ5 path,.style-module--coffeeDashedOn--10CU2 path{stroke-dasharray:20 20;stroke-dashoffset:1547;animation:style-module--pathAnimation--1daA1 20s linear infinite;animation-play-state:paused}.style-module--coffeeDashedOn--10CU2 path{animation-play-state:running}@keyframes style-module--pathAnimation--1daA1{to{stroke-dashoffset:0}}.style-module--coffeeDrawselfOff--3eLLW,.style-module--coffeeDrawselfOn--1q9xE{max-width:250px;max-height:375px;width:100%;height:100%;margin:auto;display:block}.style-module--coffeeDrawselfOff--3eLLW path,.style-module--coffeeDrawselfOn--1q9xE path{animation-play-state:running;stroke-dasharray:1547 1547;stroke-dashoffset:0;animation:style-module--pathAnimation--i-DQt 12s linear infinite}.style-module--coffeeDrawselfOff--3eLLW path{animation-play-state:paused}@keyframes style-module--pathAnimation--i-DQt{0%{stroke-dashoffset:0}0.1%{stroke-dashoffset:1547}95%,to{stroke-dashoffset:0}}.style-module--cupcakeDrawself--pHn5_,.style-module--cupcakeDrawselfFade--3jS_7{max-width:250px;max-height:250px;width:100%;height:100%;margin:auto;display:block}.style-module--staticCircles--2D1Sl{max-width:300px}.style-module--control--1NRP7{margin:.25rem}body{--color-text:var(--darkgrey);--color-bg:var(--white);--color-secondary:var(--darkgrey);--color-tertiary:var(--lightgrey)}body,body.dark{--color-primary:var(--skyblue)}body.dark{--color-text:var(--white);--color-bg:var(--darkblue);--color-secondary:var(--white);--color-tertiary:var(--ldarkblue)}body,html{height:100%;font-family:Alegreya Sans SC,sans-serif;font-weight:300;font-size:1.1rem;color:var(--color-text);background-color:var(--color-bg)}body,html,p{margin:0;padding:0}p{line-height:1.5}button{color:var(--white);background-color:var(--color-primary);font-size:1.2rem;text-decoration:none;border-radius:3px;border:1px solid var(--darkgrey);display:inline-block;cursor:pointer;padding:.5rem 1rem}.blueLink,.footnote-backref,.footnote-ref{color:var(--color-primary);text-decoration:none;background-image:linear-gradient(0deg,var(--color-primary),var(--color-primary) 50%,transparent 0,transparent);background-position:0 0;background-size:100% 200%;transition-duration:.5s}.blueLink:hover,.footnote-backref:hover,.footnote-ref:hover{color:var(--white);background-position:0 100%}:root{--skyblue:#00a3a3;--darkgrey:#696969;--lightgrey:#ebebe0;--white:#fff;--darkblue:#16202c;--ldarkblue:#273342}.style-module--logo--2SyxD{width:4rem;height:4rem;padding:.25rem;display:block}.style-module--header--SW0YW,.style-module--headerClosed--R_-JQ{background-color:var(--color-tertiary);position:fixed;top:0;width:100%;transition:top .3s}.style-module--headerClosed--R_-JQ{top:-5rem}.style-module--navBar--15oEh{display:flex;align-items:center}.style-module--navBarMenu--2bl_U{margin-left:auto;text-align:center;display:none}.style-module--navBarItem--WLqjh{font-size:1.2rem;padding:1.563rem 1rem;color:var(--color-primary);text-decoration:none;cursor:pointer;transition-duration:.5s}.style-module--navBarItem--WLqjh:hover{background:var(--color-primary);color:var(--color-tertiary)}.style-module--navButton--1tUmD{display:flex;background:none;border:none;width:4.5rem;height:4.5rem;padding:0;cursor:pointer;margin-left:auto;color:var(--color-primary);transition-duration:.5s}.style-module--navButton--1tUmD:hover{background:var(--color-primary);color:var(--color-tertiary)}.style-module--navButtonIcon--3NMNz{margin:auto}.style-module--sideBarColourThemeToggler--U1SHt{display:none;padding:.5rem}@media (min-width:1023px){.style-module--navBarMenu--2bl_U{display:flex}.style-module--sideBarColourThemeToggler--U1SHt{display:block}.style-module--navButton--1tUmD{display:none}}.style-module--footer--289ra{background-color:var(--color-tertiary);padding:1rem 0;font-size:1.2rem;text-align:center}.style-module--socialIcons--1q-EP{display:flex;justify-content:center}.style-module--socialIconLink--3nB_V{width:4.5rem;height:4.5rem}.style-module--socialIcon--2dsOi{color:var(--color-secondary);height:100%;transition-duration:.5s}.style-module--socialIcon--2dsOi:hover{color:var(--color-primary)}.style-module--logo--36eDR{width:4rem;height:4rem;padding:.25rem;display:block}.style-module--sidebar--1_Ajg,.style-module--sidebarOpen--8w5ak{height:100%;background-color:var(--color-tertiary);box-shadow:1px 0 7px rgba(0,0,0,.5);width:50%;max-width:15rem;position:fixed;top:0;left:0;overflow-x:hidden;z-index:200;display:flex;flex-direction:column;transform:translateX(-110%);transition:transform .3s ease-out}.style-module--sidebarOpen--8w5ak{transform:translateX(0)}@media(min-width:1023px){.style-module--sidebarOpen--8w5ak{transform:translateX(-110%)}}.style-module--sidebarNav--3227e{display:flex;flex-direction:column}.style-module--sidebarNavItem--am4DC{font-size:1.5rem;color:var(--color-primary);padding:.5rem;text-decoration:none;cursor:pointer;transition-duration:.5s}.style-module--sidebarNavItem--am4DC:hover{background-color:var(--color-primary);color:var(--color-tertiary)}.style-module--sideBarColourThemeToggler--DEL2c{padding:.5rem}.style-module--backdrop--3vELK{position:fixed;width:100%;height:100%;top:0;left:0;background:rgba(0,0,0,.3);z-index:100}@media(min-width:1023px){.style-module--backdrop--3vELK{display:none}}.style-module--fixedFooterWrapper--2Ir75{display:grid;margin-top:4.5rem;height:100vh;grid-template-rows:1fr auto}.style-module--postHeader--2ErCw{color:var(--color-primary);padding-bottom:1rem}.style-module--postTitle--17UcY{margin:0;font-weight:900}.style-module--postDate--3wGWt{font-size:1.4rem}.style-module--postContainer--2odKR{display:grid;grid-template-columns:1fr minmax(18rem,46rem) 1fr}.style-module--post--3mvXb{padding:15px;grid-column:2/span 1}.style-module--footnote-backref--1ZlkF,.style-module--footnote-ref--3RG69{color:var(--color-primary);text-decoration:none;background-image:linear-gradient(0deg,var(--color-primary),var(--color-primary) 50%,transparent 0,transparent);background-position:0 0;background-size:100% 200%;transition-duration:.5s}.style-module--footnote-backref--1ZlkF:hover,.style-module--footnote-ref--3RG69:hover{color:var(--white);background-position:0 100%}.style-module--post--3mvXb h2{color:var(--color-primary);font-weight:900;margin:0}.style-module--post--3mvXb p{margin:1rem 0}.style-module--post--3mvXb button:hover{transition-duration:.5s;background-color:var(--darkblue)}.style-module--post--3mvXb button:active{position:relative;top:1px}.style-module--logoBrackets--1WZBy{max-width:500px;max-height:320px;width:100%;height:100%;display:flex;display:block;margin:1rem auto}.style-module--introText--1XiXJ{text-align:center}.style-module--paginator--2j0wi{display:flex;justify-content:center;padding:.5rem;font-size:1.2rem}.style-module--paginatorList--yTa4i{list-style:none;margin:0;padding:0;display:flex}.style-module--paginatorLink--2SoYG,.style-module--paginatorLinkActive--1qV2c{text-decoration:none;color:var(--color-primary);display:block;padding:.5rem .75rem}.style-module--paginatorLinkActive--1qV2c{background-color:var(--color-primary);color:var(--color-bg);border-radius:.5rem}.style-module--postListItem--2u-tp{padding:0 .5rem;margin:.5rem 0}.style-module--postListItem--2u-tp:hover{background:var(--color-tertiary);transition-duration:.5s}.style-module--postLink--VKmXi{display:block;text-decoration:none;max-width:700px;margin:0 auto;color:var(--color-primary)}.style-module--postTitle--gRT3u{margin:0;font-weight:900}.style-module--postMeta--1VUrD{font-weight:600}.style-module--postSubtitle--zGGxE{color:var(--color-text)}.style-module--postImage--155ya{padding:.5rem;display:block;height:16rem;margin:0 auto}.style-module--logoBracketsNotFound--395TM{max-width:650px;max-height:500px;width:100%;height:100%;display:block;margin:1em auto}.style-module--container--3FVkj{display:block;margin:1em auto;text-align:center}.style-module--about--2Q3vK{display:flex;justify-content:center;align-items:center;flex-wrap:wrap;padding:1em}.style-module--profile--2FNl5{margin:1em;height:auto;width:100%;max-width:20em;border-radius:50%;padding:.25em;border:2px solid var(--color-tertiary)}.style-module--aboutText--3eSjh{padding:1em;max-width:24em}.style-module--photosTitle--1i4eW{color:var(--color-primary);font-weight:900;margin:0;text-align:center}.style-module--gallery--1W-CY{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));grid-gap:1em;padding:1em;text-align:center}.style-module--galleryImage--1f_9c{width:300px;height:200px}</style><meta name="generator" content="Gatsby 2.20.9"/><link rel="icon" href="/icons/icon-48x48.png?v=6ebb8f3ede62d3a9076af908ad25740f"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#ebebe0"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=6ebb8f3ede62d3a9076af908ad25740f"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=6ebb8f3ede62d3a9076af908ad25740f"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=6ebb8f3ede62d3a9076af908ad25740f"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=6ebb8f3ede62d3a9076af908ad25740f"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=6ebb8f3ede62d3a9076af908ad25740f"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=6ebb8f3ede62d3a9076af908ad25740f"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=6ebb8f3ede62d3a9076af908ad25740f"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=6ebb8f3ede62d3a9076af908ad25740f"/><title data-react-helmet="true"></title><link as="script" rel="preload" href="/component---src-pages-posts-2019-05-19-sobel-index-mdx-11023be92269b6fec8e7.js"/><link as="script" rel="preload" href="/framework-a09ec8c79d293ea3287b.js"/><link as="script" rel="preload" href="/795ab356-208aff79ac8ee20e87f0.js"/><link as="script" rel="preload" href="/app-bfa6f7b308fcdb359827.js"/><link as="script" rel="preload" href="/06fa0f4b-4b158235cd7b97b0eebf.js"/><link as="script" rel="preload" href="/cb1608f2-6b0fac0b6bb4a8158376.js"/><link as="script" rel="preload" href="/styles-85a04149be4e142495ba.js"/><link as="script" rel="preload" href="/webpack-runtime-b0f2cf3f936a5442d42f.js"/><link as="fetch" rel="preload" href="/page-data\posts\2019-05-19-sobel\page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data\app-data.json" crossorigin="anonymous"/></head><body><script>
void function() {
  window.__onThemeChange = function() {}

  var preferredTheme
  try {
    preferredTheme = localStorage.getItem('theme')
  } catch (err) { }

  function setTheme(newTheme) {
    if (preferredTheme && document.body.classList.contains(preferredTheme)) {
      document.body.classList.replace(preferredTheme, newTheme)
    } else {
      document.body.classList.add(newTheme)
    }

    window.__theme = newTheme
    preferredTheme = newTheme
    window.__onThemeChange(newTheme)
  }

  window.__setPreferredTheme = function(newTheme) {
    setTheme(newTheme)
    try {
      localStorage.setItem('theme', newTheme)
    } catch (err) {}
  }

  var darkQuery = window.matchMedia('(prefers-color-scheme: dark)')
  darkQuery.addListener(function(e) {
    window.__setPreferredTheme(e.matches ? 'dark' : 'light')
  })

  setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'))
}()
    </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><p>I recently watched a <a class="blueLink" href="https://youtu.be/uihBwtPIBxM">Computerphile YouTube video</a> about Sobel edge detection and thought I&#x27;d write a post about it. In Sobel edge detection a <a href="https://en.wikipedia.org/wiki/Sobel_operator" class="blueLink">Sobel operation</a> is applied to an image in order to detect shapes/edges in the image. The main application of edge detection is in robotic vision, for example allowing self-driving vehicles to detect motorway lanes, but it can be used for any image analysis.</p><p>The first step in the Sobel operation is to <a href="https://en.wikipedia.org/wiki/Grayscale" class="blueLink">greyscale</a> the image. This can be done with a few lines of JavaScript code:</p><pre><code class="language-javascript">var gsFigure = document.querySelector(&quot;#fig-greyscale&quot;);
var gsImage = gsFigure.querySelector(&quot;img&quot;);
var gsCanvas = gsFigure.querySelector(&quot;canvas&quot;);
var gsbutton = gsFigure.querySelector(&quot;.button&quot;);
var gsCtx = gsCanvas.getContext(&quot;2d&quot;);

gsbutton.addEventListener(&quot;click&quot;, () =&gt; {
  gsCanvas.width = gsImage.width;
  gsCanvas.height = gsImage.height;
  gsCtx.drawImage(gsImage, 0, 0);
  var gsImageData = gsCtx.getImageData(0, 0, gsCanvas.width, gsCanvas.height);
  var id = greyScale(gsImageData);
  gsCtx.putImageData(id, 0, 0);
}

function greyScale (imageData) {
  var d = imageData.data;
  for (var i=0; i&lt;d.length; i+=4) {
    var r = d[i];
    var g = d[i+1];
    var b = d[i+2];
    // CIE luminance for RGB
    // Human vision is most sensitive to green, so this has the greatest coefficient value.
    var v = 0.2126*r + 0.7152*g + 0.0722*b;
    d[i] = d[i+1] = d[i+2] = v
  }
  return imageData;
};
</code></pre><div><div class="style-module--container--3pYZP"><canvas class="style-module--displayHidden--21VAm"></canvas><img class="style-module--displayBlock--iPhpg" src="/static/flower-0d2af2065c083858be1918cf3e68f507.png" alt="flower"/></div><div class="style-module--controls--1ld-o"><button>Apply</button></div></div><p>The next step in the Sobel operation is to <a class="blueLink" href="https://en.wikipedia.org/wiki/Kernel_(image_processing)#Convolution">convolve</a> the image with two 3x3 <a class="blueLink" href="https://en.wikipedia.org/wiki/Kernel_(image_processing)">kernels</a>, <code>Gx</code> and <code>Gy</code>. What this basically means is the strength of each pixel is weighted by its neighbours. The magnitude of <code>Gx</code> is greatest when the pixels to the right and left of the pixel being convolved are most different, whereas the magnitude of <code>Gy</code> is greatest when the pixels above and below are most different. <code>Gx</code> and <code>Gy</code> can therefore be considered gradient functions and effectively emphasise edges in the x and y directions respectively.</p><pre><code class="language-javascript">     |-1 0 +1|               |-1 -2 -1|
Gx = |-2 0 +2| * A  ,   Gy = | 0  0  0| * A  ,  where A is the source image.
     |-1 0 +1|               |+1 +2 +1|
</code></pre><p>The gradient functions can be combined to form a gradient magnitude <code>G = sqrt(Gx^2 + Gy^2)</code>. This produces an image where all the areas with large changes in pixel intensity (edges) are highlighted, just hit the button below to see an example:</p><div><div class="style-module--container--3pYZP"><canvas class="style-module--displayHidden--21VAm"></canvas><img class="style-module--displayBlock--iPhpg" src="/static/flower-0d2af2065c083858be1918cf3e68f507.png" alt="flower"/></div><div class="style-module--controls--1ld-o"><button>Apply</button></div></div><img class="style-module--colourWheel--2-rSW" src="/static/colourWheel-111a5fbabdc1c4bb3fc654a763b5a531.png" alt="colour wheel"/><p>In fact we can even find out the orientation of the edges by taking the arctan of the gradient functions, <code>θ = atan(Gy/Gx)</code>. The orientation can then be mapped to a colour using a colour wheel. Try running the example Sobel operation below:</p><div><div class="style-module--container--3pYZP"><canvas class="style-module--displayHidden--21VAm"></canvas><img class="style-module--displayBlock--iPhpg" src="/static/flower-0d2af2065c083858be1918cf3e68f507.png" alt="flower"/></div><div class="style-module--controls--1ld-o"><button>Apply</button></div></div><p>Wow that&#x27;s pretty fancy! Notice how the edges orientation maps to that of the colour wheel.</p><p>Finally have a play with the JavaScript tool below allowing you to create your own Sobel images. The saturation input controls the amount of orientational colour added. Also I&#x27;ve set it to scale the images to 600px for performance.</p><div><canvas width="0" height="0"></canvas><button>Select an Image</button><input type="file" accept="image/*" class="style-module--displayHidden--2K05X"/></div><h2>Further reading / watching</h2><ul><li><a class="blueLink" href="https://youtu.be/uihBwtPIBxM">Finding the Edges (Sobel Operator) - Computerphile</a></li><li><a class="blueLink" href="https://www.html5rocks.com/en/tutorials/canvas/imagefilters/">Image Filters with Canvas</a></li></ul></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/posts/2019-05-19-sobel/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-bfa6f7b308fcdb359827.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-288479fdde1b1924312e.js"],"component---src-templates-post-template-post-template-js":["/component---src-templates-post-template-post-template-js-2f454f3ee2e04921d209.js"],"component---src-templates-post-list-template-post-list-template-js":["/component---src-templates-post-list-template-post-list-template-js-fb9dedee2b8c9e329915.js"],"component---src-pages-404-index-js":["/component---src-pages-404-index-js-7be493e368732f41f45a.js"],"component---src-pages-about-index-js":["/component---src-pages-about-index-js-6850c22aa90337c6fc45.js"],"component---src-pages-photos-index-js":["/component---src-pages-photos-index-js-4f6b0a2a7400fd1b8b57.js"],"component---src-pages-posts-2019-02-09-hello-world-index-mdx":["/component---src-pages-posts-2019-02-09-hello-world-index-mdx-db4a48102dcf02e1d8d9.js"],"component---src-pages-posts-2019-02-20-diamond-square-algorithm-cloud-images-index-mdx":["/component---src-pages-posts-2019-02-20-diamond-square-algorithm-cloud-images-index-mdx-13c0437e6351f261854b.js"],"component---src-pages-posts-2019-04-06-the-game-of-life-index-mdx":["/component---src-pages-posts-2019-04-06-the-game-of-life-index-mdx-6a231ee35d973fbc3e37.js"],"component---src-pages-posts-2019-06-17-circles-everywhere-index-mdx":["/component---src-pages-posts-2019-06-17-circles-everywhere-index-mdx-9c3ba1a1b26c12e8d598.js"],"component---src-pages-posts-2019-05-19-sobel-index-mdx":["/component---src-pages-posts-2019-05-19-sobel-index-mdx-11023be92269b6fec8e7.js"],"component---src-pages-posts-2019-08-11-moire-patterns-index-mdx":["/component---src-pages-posts-2019-08-11-moire-patterns-index-mdx-5db95d7c08b4524b3e60.js"],"component---src-pages-posts-2019-11-10-from-ruby-to-react-index-mdx":["/component---src-pages-posts-2019-11-10-from-ruby-to-react-index-mdx-b8b7578a0820e228decb.js"],"component---src-pages-posts-2019-07-23-putting-svgs-on-the-map-index-mdx":["/component---src-pages-posts-2019-07-23-putting-svgs-on-the-map-index-mdx-263ad0767d84bc6335e5.js"],"component---src-pages-posts-2019-03-06-svg-path-animations-index-mdx":["/component---src-pages-posts-2019-03-06-svg-path-animations-index-mdx-0ebec60cc57a635083f1.js"]};/*]]>*/</script><script src="/webpack-runtime-b0f2cf3f936a5442d42f.js" async=""></script><script src="/styles-85a04149be4e142495ba.js" async=""></script><script src="/cb1608f2-6b0fac0b6bb4a8158376.js" async=""></script><script src="/06fa0f4b-4b158235cd7b97b0eebf.js" async=""></script><script src="/app-bfa6f7b308fcdb359827.js" async=""></script><script src="/795ab356-208aff79ac8ee20e87f0.js" async=""></script><script src="/framework-a09ec8c79d293ea3287b.js" async=""></script><script src="/component---src-pages-posts-2019-05-19-sobel-index-mdx-11023be92269b6fec8e7.js" async=""></script></body></html>