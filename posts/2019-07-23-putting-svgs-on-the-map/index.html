<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.f35ab87a51c5aaa3aebb.css">.style-module--displayNone--2rZ5S{display:none}.style-module--dislayBlock--3OXtv{display:block}.style-module--controlGroup--1sL_L{padding:.5rem 0}.style-module--control--fRXxc{margin:.25rem}.style-module--hexagonalLatticeExample--19TsT{stroke-width:3;display:block;margin:0 auto}.style-module--circlesExample--3MMKq,.style-module--linesExample--Ogm8H{stroke-width:3;stroke:#930;display:block;margin:0 auto}.style-module--circlesExample--3MMKq{fill:None}.style-module--displayBlock--2BDsS{display:block}.style-module--displayHidden--1cmzY{display:none}.style-module--container--2QO0X{overflow-x:scroll}.style-module--controls--2oYnC{padding-top:.5rem}.style-module--inputControl--2oZfe{margin:0 .5rem}.style-module--logoDrawself--3MgBP{max-width:400px;max-height:400px;width:100%;height:100%;display:block;margin:auto}.style-module--coffeeDashedOff--2PfJ5,.style-module--coffeeDashedOn--10CU2{max-width:250px;max-height:375px;width:100%;height:100%}.style-module--coffeeDashedOff--2PfJ5 path,.style-module--coffeeDashedOn--10CU2 path{stroke-dasharray:20 20;stroke-dashoffset:1547;-webkit-animation:style-module--pathAnimation--1daA1 20s linear infinite;animation:style-module--pathAnimation--1daA1 20s linear infinite;-webkit-animation-play-state:paused;animation-play-state:paused}.style-module--coffeeDashedOn--10CU2 path{-webkit-animation-play-state:running;animation-play-state:running}@-webkit-keyframes style-module--pathAnimation--1daA1{to{stroke-dashoffset:0}}@keyframes style-module--pathAnimation--1daA1{to{stroke-dashoffset:0}}.style-module--coffeeDrawselfOff--3eLLW,.style-module--coffeeDrawselfOn--1q9xE{max-width:250px;max-height:375px;width:100%;height:100%;margin:auto;display:block}.style-module--coffeeDrawselfOff--3eLLW path,.style-module--coffeeDrawselfOn--1q9xE path{-webkit-animation-play-state:running;animation-play-state:running;stroke-dasharray:1547 1547;stroke-dashoffset:0;-webkit-animation:style-module--pathAnimation--i-DQt 12s linear infinite;animation:style-module--pathAnimation--i-DQt 12s linear infinite}.style-module--coffeeDrawselfOff--3eLLW path{-webkit-animation-play-state:paused;animation-play-state:paused}@-webkit-keyframes style-module--pathAnimation--i-DQt{0%{stroke-dashoffset:0}0.1%{stroke-dashoffset:1547}95%,to{stroke-dashoffset:0}}@keyframes style-module--pathAnimation--i-DQt{0%{stroke-dashoffset:0}0.1%{stroke-dashoffset:1547}95%,to{stroke-dashoffset:0}}.style-module--cupcakeDrawself--pHn5_,.style-module--cupcakeDrawselfFade--3jS_7{max-width:250px;max-height:250px;width:100%;height:100%;margin:auto;display:block}.common-module--halfWidthContainer--1O3jv{display:grid;grid-template-columns:1fr 1fr}.common-module--halfWidthLeft--YeN8C{grid-column:1/span 1;padding-right:1em}.common-module--halfWidthRight--IjbdE{grid-column:2/span 1;padding-left:1em}@media (max-width:46rem){.common-module--halfWidthLeft--YeN8C,.common-module--halfWidthRight--IjbdE{grid-column:1/span 2;justify-self:center;padding-right:0;padding-left:0}}.style-module--displayBlock--iPhpg{display:block}.style-module--displayHidden--21VAm{display:none}.style-module--container--3pYZP{overflow-x:scroll}.style-module--controls--1ld-o{margin:.5rem 0}.style-module--displayHidden--2K05X{display:none}.style-module--saturation--1RogJ{padding:1rem 0}.style-module--colourWheel--2-rSW{margin:auto;display:block}.style-module--staticCircles--2D1Sl{max-width:300px}.style-module--control--1NRP7{margin:.25rem}.style-module--container--1QUVW{overflow-x:scroll}.style-module--controls--1y8XI{padding-top:.5rem}.style-module--control--vLe4q{margin:.25rem}body,html{height:100%;font-family:Alegreya Sans SC,sans-serif;font-weight:300;font-size:1.1rem}body,html,p{margin:0;padding:0}p{line-height:1.5}.blueLink,.footnote-backref,.footnote-ref{color:var(--skyblue);text-decoration:none;background-image:-webkit-gradient(linear,left bottom,left top,from(var(--skyblue)),color-stop(50%,var(--skyblue)),color-stop(50%,transparent),to(transparent));background-image:linear-gradient(0deg,var(--skyblue),var(--skyblue) 50%,transparent 0,transparent);background-position:0 0;background-size:100% 200%;-webkit-transition-duration:.5s;transition-duration:.5s}.blueLink:hover,.footnote-backref:hover,.footnote-ref:hover{color:var(--white);background-position:0 100%}:root{--skyblue:#00a3a3;--darkblue:#09616c;--darkgrey:#696969;--grey:#e0e0e0;--lightgrey:#ebebe0;--white:#fff;--darkgreen:#09616c}.style-module--logo--2SyxD{width:4rem;height:4rem;padding:.25rem;display:block}.style-module--header--SW0YW,.style-module--headerClosed--R_-JQ{background-color:var(--lightgrey);position:fixed;top:0;width:100%;-webkit-transition:top .3s;transition:top .3s}.style-module--headerClosed--R_-JQ{top:-5rem}.style-module--navBar--15oEh{display:flex;align-items:center}.style-module--navBarMenu--2bl_U{margin-left:auto;text-align:center;display:none}.style-module--navBarItem--WLqjh{font-size:1.2rem;padding:1.563rem 1rem;color:var(--skyblue);text-decoration:none;cursor:pointer;-webkit-transition-duration:.5s;transition-duration:.5s}.style-module--navBarItem--WLqjh:hover{background:var(--grey)}.style-module--navButton--1tUmD{display:flex;background:none;border:none;width:4.5rem;height:4.5rem;padding:0;cursor:pointer;margin-left:auto;color:var(--darkgrey);-webkit-transition-duration:.5s;transition-duration:.5s}.style-module--navButton--1tUmD:hover{background:var(--grey)}.style-module--navButtonIcon--3NMNz{margin:auto}@media (min-width:1023px){.style-module--navBarMenu--2bl_U{display:flex}.style-module--navButton--1tUmD{display:none}}.style-module--footer--289ra{background-color:var(--lightgrey);padding:1rem 0;font-size:1.2rem;color:var(--darkgrey);text-align:center}.style-module--socialIcons--1q-EP{display:flex;justify-content:center}.style-module--socialIconLink--3nB_V{width:4.5rem;height:4.5rem}.style-module--socialIcon--2dsOi{color:var(--darkgrey);height:100%;-webkit-transition-duration:.5s;transition-duration:.5s}.style-module--socialIcon--2dsOi:hover{color:var(--skyblue)}.style-module--logo--36eDR{width:4rem;height:4rem;padding:.25rem;display:block}.style-module--sidebar--1_Ajg,.style-module--sidebarOpen--8w5ak{height:100%;background-color:var(--darkgrey);box-shadow:1px 0 7px rgba(0,0,0,.5);width:50%;max-width:15rem;position:fixed;top:0;left:0;overflow-x:hidden;z-index:200;display:flex;flex-direction:column;-webkit-transform:translateX(-110%);transform:translateX(-110%);-webkit-transition:-webkit-transform .3s ease-out;transition:-webkit-transform .3s ease-out;transition:transform .3s ease-out;transition:transform .3s ease-out,-webkit-transform .3s ease-out}.style-module--sidebarOpen--8w5ak{-webkit-transform:translateX(0);transform:translateX(0)}.style-module--sidebarItem--CIFyC{font-size:1.5rem;color:var(--skyblue);padding:.5rem;text-decoration:none;cursor:pointer;-webkit-transition-duration:.5s;transition-duration:.5s}.style-module--sidebarItem--CIFyC:hover{background-color:var(--grey)}@media(min-width:1023px){.style-module--sidebarOpen--8w5ak{-webkit-transform:translateX(-110%);transform:translateX(-110%)}}.style-module--backdrop--3vELK{position:fixed;width:100%;height:100%;top:0;left:0;background:rgba(0,0,0,.3);z-index:100}@media(min-width:1023px){.style-module--backdrop--3vELK{display:none}}.style-module--fixedFooterWrapper--2Ir75{display:grid;margin-top:4.5rem;height:100vh;grid-template-rows:1fr auto}.style-module--postHeader--2ErCw{color:var(--skyblue);padding-bottom:1rem}.style-module--postTitle--17UcY{margin:0;font-weight:900}.style-module--postDate--3wGWt{font-size:1.4rem}.style-module--postContainer--2odKR{display:grid;grid-template-columns:1fr minmax(18rem,46rem) 1fr}.style-module--post--3mvXb{color:var(--darkgrey);padding:15px;grid-column:2/span 1}.style-module--footnote-backref--1ZlkF,.style-module--footnote-ref--3RG69{color:var(--skyblue);text-decoration:none;background-image:-webkit-gradient(linear,left bottom,left top,from(var(--skyblue)),color-stop(50%,var(--skyblue)),color-stop(50%,transparent),to(transparent));background-image:linear-gradient(0deg,var(--skyblue),var(--skyblue) 50%,transparent 0,transparent);background-position:0 0;background-size:100% 200%;-webkit-transition-duration:.5s;transition-duration:.5s}.style-module--footnote-backref--1ZlkF:hover,.style-module--footnote-ref--3RG69:hover{color:var(--white);background-position:0 100%}.style-module--post--3mvXb h2{color:var(--darkgreen);font-weight:900;margin:0}.style-module--post--3mvXb p{margin:1rem 0}.style-module--post--3mvXb button{color:var(--white);background-color:var(--skyblue);font-size:1.2rem;text-decoration:none;border-radius:3px;border:1px solid var(--darkgrey);display:inline-block;cursor:pointer;padding:.5rem 1rem}.style-module--post--3mvXb button:hover{-webkit-transition-duration:.5s;transition-duration:.5s;background-color:var(--darkblue)}.style-module--post--3mvXb button:active{position:relative;top:1px}.style-module--logoBrackets--1WZBy{max-width:500px;max-height:320px;width:100%;height:100%;display:flex;display:block;margin:1rem auto}.style-module--introText--1XiXJ{color:var(--darkgrey);text-align:center}.style-module--paginator--2j0wi{display:flex;justify-content:center;padding:.5rem;font-size:1.2rem}.style-module--paginatorList--yTa4i{list-style:none;margin:0;padding:0;display:flex}.style-module--paginatorLink--2SoYG,.style-module--paginatorLinkActive--1qV2c{text-decoration:none;color:var(--skyblue);display:block;padding:.5rem .75rem}.style-module--paginatorLinkActive--1qV2c{background-color:var(--grey);border-radius:.5rem}.style-module--postListItem--2u-tp{padding:0 .5rem;margin:.5rem 0}.style-module--postListItem--2u-tp:hover{background:var(--lightgrey);-webkit-transition-duration:.5s;transition-duration:.5s}.style-module--postLink--VKmXi{display:block;text-decoration:none;max-width:700px;margin:0 auto;color:var(--skyblue)}.style-module--postTitle--gRT3u{margin:0;font-weight:900}.style-module--postMeta--1VUrD{font-weight:600}.style-module--postSubtitle--zGGxE{color:var(--darkgrey)}.style-module--postImage--155ya{padding:.5rem;display:block;height:16rem;margin:0 auto}.style-module--logoBracketsNotFound--395TM{max-width:650px;max-height:500px;width:100%;height:100%;display:block;margin:1em auto}.style-module--container--3FVkj{color:var(--darkgrey);display:block;margin:1em auto;text-align:center}.style-module--about--2Q3vK{color:var(--darkgrey);display:flex;justify-content:center;align-items:center;flex-wrap:wrap;padding:1em}.style-module--profile--2FNl5{margin:1em;height:auto;width:100%;max-width:20em;border-radius:50%;padding:.25em;border:2px solid var(--lightgrey)}.style-module--aboutText--3eSjh{padding:1em;max-width:24em}.style-module--photosTitle--1i4eW{color:var(--darkgreen);font-weight:900;margin:0;text-align:center}.style-module--gallery--1W-CY{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));grid-gap:1em;padding:1em;text-align:center}.style-module--galleryImage--1f_9c{width:300px;height:200px}</style><meta name="generator" content="Gatsby 2.17.7"/><link rel="icon" href="/icons/icon-48x48.png?v=6abe064f28b01bcab920a40115ff3ff7"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#ebebe0"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=6abe064f28b01bcab920a40115ff3ff7"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=6abe064f28b01bcab920a40115ff3ff7"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=6abe064f28b01bcab920a40115ff3ff7"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=6abe064f28b01bcab920a40115ff3ff7"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=6abe064f28b01bcab920a40115ff3ff7"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=6abe064f28b01bcab920a40115ff3ff7"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=6abe064f28b01bcab920a40115ff3ff7"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=6abe064f28b01bcab920a40115ff3ff7"/><title data-react-helmet="true"></title><link as="script" rel="preload" href="/styles-13faa0858667f5b1907d.js"/><link as="script" rel="preload" href="/component---src-pages-posts-2019-07-23-putting-svgs-on-the-map-index-mdx-445977f1e8565ea0c3d6.js"/><link as="script" rel="preload" href="/commons-72714eaa17a825ef31ae.js"/><link as="script" rel="preload" href="/app-da2345a3494ea546e690.js"/><link as="script" rel="preload" href="/webpack-runtime-afced5c25edb55a4651d.js"/><link as="fetch" rel="preload" href="/page-data\posts\2019-07-23-putting-svgs-on-the-map\page-data.json" crossorigin="anonymous"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><p>In the <a class="blueLink" href="/2019-06-17-circles-everywhere">previous blog post</a> I showed how to generate Scalable Vector Graphics (SVGs) of small circles packed inside a larger circle using JavaScript. In today&#x27;s post I&#x27;m packing circles inside a map of the UK and Ireland.</p><p>The first thing we will need is a black and white map of the UK and Ireland. This is surprisingly difficult to find online, but after some intense search engine work I was able to get one:</p><img style="width:100%;max-width:30rem" src="/static/UKAndIreland-7057d1a9df3f5556a887e47dc0907476.png" alt="UK and Ireland"/><p>A black and white image allows us to easily check whether a pixel in the image is land (black) or sea (white), using its RGB(Red, Green, Blue) values. White, RGB(255, 255, 255), pixels will have an average RGB of 255 whereas black, RGB(0, 0, 0), pixels will have an average RGB of 0.</p><p>The majority of the code is much the same as <a class="blueLink" href="/2019-06-17-circles-everywhere">before</a>, we just need to change how the circles are placed:</p><pre><code class="language-javascript">const image = document.querySelector(&quot;#uk_and_ireland&quot;);
const LX = image.width;
const LY = image.height;
const canvas = figure.querySelector(&quot;canvas&quot;);
canvas.width = LX;
canvas.height = LY;
const ctx = canvas.getContext(&quot;2d&quot;);
ctx.drawImage(image, 0, 0);
const imageData = ctx.getImageData(0, 0, LX, LY).data;

function placeCircle(circles, radius, imageData, circleColours, LX, LY) {
  //The guard number: if we don&#x27;t place a circle within this number of trials, we give up.
  let guard = 500;
  while (guard &gt; 0) {
    // Pick a random position on the image.
    const cx = randomIntFromInterval(0, LX - 1);
    const cy = randomIntFromInterval(0, LY - 1);
    const index = (cx + cy * LX) * 4;
    const red = imageData[index + 0];
    const green = imageData[index + 1];
    const blue = imageData[index + 2];
    const average = (red + green + blue) / 3;
    const overlaps = circles.some(existingCircle =&gt;
      overlapWith(
        cx,
        cy,
        radius,
        existingCircle.cx,
        existingCircle.cy,
        existingCircle.r
      )
    );
    // The circle doesn&#x27;t overlap with any other circles and its in the dark image area.
    if (!overlaps &amp;&amp; average &lt; 255 / 2) {
      const circle = {
        cx: cx,
        cy: cy,
        r: radius,
        colour: circleColours[randomIntFromInterval(0, 3)],
      };
      circles.push(circle);
      return;
    }
    guard -= 1;
  }
}
</code></pre><p>We can use the half way point between 0 and 255 (128) to determine if a pixel is black or white. If the pixel is black and the circle doesn&#x27;t overlap with any of the others then we place it otherwise we find a different location on the image.</p><p>The finished result (with 3000 circle place attempts!) looks pretty good:</p><img style="width:100%;max-width:30rem" src="/static/UKAndIrelandCircles-3c2252445c64e0335d2b7a2e4cb880b1.png" alt="UK and Ireland Circles"/><p>Here&#x27;s a smaller interactive version, so you can make your own:</p><div><img src="/static/UKAndIrelandSmall-74fca5f8e354cbe7f8b25681a80174fa.png" alt="UK and Ireland"/><canvas class="style-module--displayNone--2rZ5S"></canvas><div><div class="style-module--controlGroup--1sL_L"><input type="color" class="style-module--control--fRXxc" value="#993300"/><input type="color" class="style-module--control--fRXxc" value="#a5c916"/><input type="color" class="style-module--control--fRXxc" value="#00AA66"/><input type="color" class="style-module--control--fRXxc" value="#FF9900"/></div><div class="style-module--controlGroup--1sL_L"><label>Min radius:</label><input type="range" class="style-module--control--fRXxc" step="0.25" min="2" max="5" value="2"/><span class="style-module--control--fRXxc">2</span></div><div class="style-module--controlGroup--1sL_L"><label>Max radius:</label><input type="range" class="style-module--control--fRXxc" step="0.25" min="5" max="8" value="8"/><span class="style-module--control--fRXxc">8</span></div><button>Run</button></div></div><p>As always all of the code is available on my <a href="https://github.com/george-pearson" class="blueLink">GitHub</a>.</p></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/posts/2019-07-23-putting-svgs-on-the-map/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-da2345a3494ea546e690.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-a7388efdc62430243a75.js"],"component---src-templates-post-template-post-template-js":["/component---src-templates-post-template-post-template-js-29030d3ddb0047f43b6b.js"],"component---src-templates-post-list-template-post-list-template-js":["/component---src-templates-post-list-template-post-list-template-js-b54ca4d48b4b4fdbb76c.js"],"component---src-pages-404-index-js":["/component---src-pages-404-index-js-77eb7ed16b95aa3424d5.js"],"component---src-pages-about-index-js":["/component---src-pages-about-index-js-2b8113ae083c423c1a6b.js"],"component---src-pages-photos-index-js":["/component---src-pages-photos-index-js-c5c2100b2830268d45db.js"],"component---src-pages-posts-2019-02-09-hello-world-index-mdx":["/component---src-pages-posts-2019-02-09-hello-world-index-mdx-eb74b49b0b68f3f04e5f.js"],"component---src-pages-posts-2019-04-06-the-game-of-life-index-mdx":["/component---src-pages-posts-2019-04-06-the-game-of-life-index-mdx-51e4b0304a7b070b32fa.js"],"component---src-pages-posts-2019-02-20-diamond-square-algorithm-cloud-images-index-mdx":["/component---src-pages-posts-2019-02-20-diamond-square-algorithm-cloud-images-index-mdx-a593102fe249560dba08.js"],"component---src-pages-posts-2019-05-19-sobel-index-mdx":["/component---src-pages-posts-2019-05-19-sobel-index-mdx-69d6de1e4fa034b902e3.js"],"component---src-pages-posts-2019-08-11-moire-patterns-index-mdx":["/component---src-pages-posts-2019-08-11-moire-patterns-index-mdx-566b34202f8dee135486.js"],"component---src-pages-posts-2019-11-10-from-ruby-to-react-index-mdx":["/component---src-pages-posts-2019-11-10-from-ruby-to-react-index-mdx-7918188b6f05a1b6172b.js"],"component---src-pages-posts-2019-06-17-circles-everywhere-index-mdx":["/component---src-pages-posts-2019-06-17-circles-everywhere-index-mdx-8d22d238e1a5bc44cc74.js"],"component---src-pages-posts-2019-07-23-putting-svgs-on-the-map-index-mdx":["/component---src-pages-posts-2019-07-23-putting-svgs-on-the-map-index-mdx-445977f1e8565ea0c3d6.js"],"component---src-pages-posts-2019-03-06-svg-path-animations-index-mdx":["/component---src-pages-posts-2019-03-06-svg-path-animations-index-mdx-d840df41228f3e3ec855.js"]};/*]]>*/</script><script src="/webpack-runtime-afced5c25edb55a4651d.js" async=""></script><script src="/app-da2345a3494ea546e690.js" async=""></script><script src="/commons-72714eaa17a825ef31ae.js" async=""></script><script src="/component---src-pages-posts-2019-07-23-putting-svgs-on-the-map-index-mdx-445977f1e8565ea0c3d6.js" async=""></script><script src="/styles-13faa0858667f5b1907d.js" async=""></script></body></html>