<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="theme-color" content="#ebebe0"/><meta name="generator" content="Gatsby 4.17.2"/><style data-href="/styles.76995b26fc4144ec773d.css" data-identity="gatsby-global-css">.style-module--logoDrawself--3YO0q{display:block;height:100%;margin:auto;max-height:400px;max-width:400px;width:100%}.style-module--coffeeDashedOff--cpRoO,.style-module--coffeeDashedOn--JHSX4{height:100%;max-height:375px;max-width:250px;width:100%}.style-module--coffeeDashedOff--cpRoO path,.style-module--coffeeDashedOn--JHSX4 path{stroke-dasharray:20 20;stroke-dashoffset:1547;-webkit-animation:style-module--pathAnimation--37uua 20s linear infinite;animation:style-module--pathAnimation--37uua 20s linear infinite;-webkit-animation-play-state:paused;animation-play-state:paused}.style-module--coffeeDashedOn--JHSX4 path{-webkit-animation-play-state:running;animation-play-state:running}@-webkit-keyframes style-module--pathAnimation--37uua{to{stroke-dashoffset:0}}@keyframes style-module--pathAnimation--37uua{to{stroke-dashoffset:0}}.style-module--coffeeDrawselfOff--k\+Afy,.style-module--coffeeDrawselfOn--ot0VZ{display:block;height:100%;margin:auto;max-height:375px;max-width:250px;width:100%}.style-module--coffeeDrawselfOff--k\+Afy path,.style-module--coffeeDrawselfOn--ot0VZ path{stroke-dasharray:1547 1547;stroke-dashoffset:0;-webkit-animation-play-state:running;animation-play-state:running;-webkit-animation:style-module--pathAnimation--f8RAE 12s linear infinite;animation:style-module--pathAnimation--f8RAE 12s linear infinite}.style-module--coffeeDrawselfOff--k\+Afy path{-webkit-animation-play-state:paused;animation-play-state:paused}@-webkit-keyframes style-module--pathAnimation--f8RAE{0%{stroke-dashoffset:0}0.1%{stroke-dashoffset:1547}95%,to{stroke-dashoffset:0}}@keyframes style-module--pathAnimation--f8RAE{0%{stroke-dashoffset:0}0.1%{stroke-dashoffset:1547}95%,to{stroke-dashoffset:0}}.style-module--cupcakeDrawself--\+oNHB,.style-module--cupcakeDrawselfFade--iQGU6{display:block;height:100%;margin:auto;max-height:250px;max-width:250px;width:100%}.common-module--halfWidthContainer--ECghV{display:grid;grid-template-columns:1fr 1fr}.common-module--halfWidthLeft--g3BwU{grid-column:1/span 1;padding-right:1em}.common-module--halfWidthRight--OFGpf{grid-column:2/span 1;padding-left:1em}@media (max-width:46rem){.common-module--halfWidthLeft--g3BwU,.common-module--halfWidthRight--OFGpf{grid-column:1/span 2;justify-self:center;padding-left:0;padding-right:0}}.style-module--displayBlock--eMhvT{display:block}.style-module--displayHidden--TVIIn{display:none}.style-module--container--TXuSg{overflow-x:scroll}.style-module--controls--6VuPB{margin:.5rem 0}.style-module--displayHidden--5ENSW{display:none}.style-module--saturation--YhY5s{padding:1rem 0}.style-module--colourWheel--U7dw1{display:block;margin:auto}.style-module--hexagonalLatticeExample--rVJZB{stroke-width:3;display:block;margin:0 auto}.style-module--container--Qn9UH{overflow-x:scroll}.style-module--linesExample--nSJNS{stroke-width:3;stroke:#930;display:block;margin:0 auto}.style-module--container--szgAX{overflow-x:scroll}.style-module--circlesExample--z5xgB{stroke-width:3;stroke:#930;fill:None;display:block;margin:0 auto}.style-module--container--6ntzH{overflow-x:scroll}.style-module--displayNone--o8ClB{display:none}.style-module--displayBlock--F5TGV{display:block}.style-module--controlGroup--x616U{padding:.5rem 0}.style-module--control--yfd3p{margin:.25rem}.style-module--staticCircles--Lx8q9{max-width:300px}.style-module--control--TxU0I{margin:.25rem}.style-module--displayBlock--JAc8U{display:block}.style-module--displayHidden--uxhQf{display:none}.style-module--container--iJvit{overflow-x:scroll}.style-module--controls--AlUvf{padding-top:.5rem}.style-module--inputControl--eIaUZ{margin:0 .5rem}.style-module--container--sNETX{overflow-x:scroll}.style-module--controls--gkGup{padding-top:.5rem}.style-module--control--FKXbF{margin:.25rem}body{--color-text:var(--darkgrey);--color-bg:var(--white);--color-primary:var(--skyblue);--color-secondary:var(--darkgrey);--color-tertiary:var(--lightgrey)}body.dark{--color-text:var(--white);--color-bg:var(--darkblue);--color-primary:var(--skyblue);--color-secondary:var(--white);--color-tertiary:var(--ldarkblue)}body,html{background-color:var(--color-bg);color:var(--color-text);font-family:Alegreya Sans SC,sans-serif;font-size:1.1rem;font-weight:300;height:100%}body,html,p{margin:0;padding:0}p{line-height:1.5}button{background-color:var(--color-primary);border:1px solid var(--darkgrey);border-radius:3px;color:var(--white);cursor:pointer;display:inline-block;font-size:1.2rem;padding:.5rem 1rem;text-decoration:none}.blueLink,.footnote-backref,.footnote-ref{background-image:linear-gradient(to top,var(--color-primary),var(--color-primary) 50%,transparent 50%,transparent);background-position:0 0;background-size:100% 200%;color:var(--color-primary);text-decoration:none;transition-duration:.5s}.blueLink:hover,.footnote-backref:hover,.footnote-ref:hover{background-position:0 100%;color:var(--white)}:root{--skyblue:#00a3a3;--darkgrey:#696969;--lightgrey:#ebebe0;--white:#fff;--darkblue:#16202c;--ldarkblue:#273342}.style-module--logo--GWswO{display:block;height:4rem;padding:.25rem;width:4rem}.style-module--header--myEcU,.style-module--headerClosed--c5hQ6{background-color:var(--color-tertiary);position:fixed;top:0;transition:top .3s;width:100%}.style-module--headerClosed--c5hQ6{top:-5rem}.style-module--navBar--\+DihE{align-items:center;display:flex}.style-module--navBarMenu--TYbWy{display:none;margin-left:auto;text-align:center}.style-module--navBarItem--SZ1UG{color:var(--color-primary);cursor:pointer;font-size:1.2rem;padding:1.563rem 1rem;text-decoration:none;transition-duration:.5s}.style-module--navBarItem--SZ1UG:hover{background:var(--color-primary);color:var(--color-tertiary)}.style-module--navButton--NbIeJ{background:none;border:none;color:var(--color-primary);cursor:pointer;display:flex;height:4.5rem;margin-left:auto;padding:0;transition-duration:.5s;width:4.5rem}.style-module--navButton--NbIeJ:hover{background:var(--color-primary);color:var(--color-tertiary)}.style-module--navButtonIcon--SrcQA{margin:auto}.style-module--sideBarColourThemeToggler--IXAOl{display:none;padding:.5rem}@media (min-width:1023px){.style-module--navBarMenu--TYbWy{display:flex}.style-module--sideBarColourThemeToggler--IXAOl{display:block}.style-module--navButton--NbIeJ{display:none}}.style-module--footer---SO6E{background-color:var(--color-tertiary);font-size:1.2rem;padding:1rem 0;text-align:center}.style-module--socialIcons--XMSV6{display:flex;justify-content:center}.style-module--socialIconLink--8nfXK{height:4.5rem;width:4.5rem}.style-module--socialIcon--oGknt{color:var(--color-secondary);height:100%;transition-duration:.5s}.style-module--socialIcon--oGknt:hover{color:var(--color-primary)}.style-module--logo--yQrrx{display:block;height:4rem;padding:.25rem;width:4rem}.style-module--sidebar--qGtPD,.style-module--sidebarOpen--s-MJ6{background-color:var(--color-tertiary);box-shadow:1px 0 7px rgba(0,0,0,.5);display:flex;flex-direction:column;height:100%;left:0;max-width:15rem;overflow-x:hidden;position:fixed;top:0;-webkit-transform:translateX(-110%);transform:translateX(-110%);transition:-webkit-transform .3s ease-out;transition:transform .3s ease-out;transition:transform .3s ease-out,-webkit-transform .3s ease-out;width:50%;z-index:200}.style-module--sidebarOpen--s-MJ6{-webkit-transform:translateX(0);transform:translateX(0)}@media(min-width:1023px){.style-module--sidebarOpen--s-MJ6{-webkit-transform:translateX(-110%);transform:translateX(-110%)}}.style-module--sidebarNav--svpn5{display:flex;flex-direction:column}.style-module--sidebarNavItem--Q7JzD{color:var(--color-primary);cursor:pointer;font-size:1.5rem;padding:.5rem;text-decoration:none;transition-duration:.5s}.style-module--sidebarNavItem--Q7JzD:hover{background-color:var(--color-primary);color:var(--color-tertiary)}.style-module--sideBarColourThemeToggler--2zwzq{padding:.5rem}.style-module--backdrop--K9E-\+{background:rgba(0,0,0,.3);height:100%;left:0;position:fixed;top:0;width:100%;z-index:100}@media(min-width:1023px){.style-module--backdrop--K9E-\+{display:none}}.style-module--fixedFooterWrapper--Ub36S{display:grid;grid-template-rows:1fr auto;height:100vh;margin-top:4.5rem}.style-module--logoBracketsNotFound--fKRAL{display:block;height:100%;margin:1em auto;max-height:500px;max-width:650px;width:100%}.style-module--container--\+WbO6{display:block;margin:1em auto;text-align:center}.style-module--about--qoOQJ{align-items:center;display:flex;flex-wrap:wrap;justify-content:center;padding:1em}.style-module--profile--BNvOE{border:2px solid var(--color-tertiary);border-radius:50%;height:auto;margin:1em;max-width:20em;padding:.25em;width:100%}.style-module--aboutText--ZmXhc{max-width:24em;padding:1em}.style-module--photosTitle--oBOg-{color:var(--color-primary);font-weight:900;margin:0;text-align:center}.style-module--gallery--ifxLt{grid-gap:1em;display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));padding:1em;text-align:center}.style-module--galleryImage--venVX{height:200px;width:300px}.style-module--logoBrackets--fdJ-s{display:flex;display:block;height:100%;margin:1rem auto;max-height:320px;max-width:500px;width:100%}.style-module--introText--3aSW0{text-align:center}.style-module--paginator--GZGFh{display:flex;font-size:1.2rem;justify-content:center;padding:.5rem}.style-module--paginatorList--HHRfo{display:flex;list-style:none;margin:0;padding:0}.style-module--paginatorLink--ui1F0,.style-module--paginatorLinkActive--\+QIc5{color:var(--color-primary);display:block;padding:.5rem .75rem;text-decoration:none}.style-module--paginatorLinkActive--\+QIc5{background-color:var(--color-primary);border-radius:.5rem;color:var(--color-bg)}.style-module--postListItem--HtJCl{margin:.5rem 0;padding:0 .5rem}.style-module--postListItem--HtJCl:hover{background:var(--color-tertiary);transition-duration:.5s}.style-module--postLink--yaCaL{color:var(--color-primary);display:block;margin:0 auto;max-width:700px;text-decoration:none}.style-module--postTitle--8DoBY{font-weight:900;margin:0}.style-module--postMeta--JQEqY{font-weight:600}.style-module--postSubtitle--U5pEk{color:var(--color-text)}.style-module--postImage--76I9h{display:block;height:16rem;margin:0 auto;padding:.5rem}.style-module--postHeader--Ctd\+b{color:var(--color-primary);padding-bottom:1rem}.style-module--postTitle--Be4x6{font-weight:900;margin:0}.style-module--postDate---Yq1I{font-size:1.4rem}.style-module--postContainer--KBAoh{display:grid;grid-template-columns:1fr minmax(18rem,46rem) 1fr}.style-module--post--p5pPq{grid-column:2/span 1;padding:15px}.style-module--footnote-backref--rh67t,.style-module--footnote-ref--pqt2P{background-image:linear-gradient(to top,var(--color-primary),var(--color-primary) 50%,transparent 50%,transparent);background-position:0 0;background-size:100% 200%;color:var(--color-primary);text-decoration:none;transition-duration:.5s}.style-module--footnote-backref--rh67t:hover,.style-module--footnote-ref--pqt2P:hover{background-position:0 100%;color:var(--white)}.style-module--post--p5pPq h2{color:var(--color-primary);font-weight:900;margin:0}.style-module--post--p5pPq p{margin:1rem 0}.style-module--post--p5pPq button:hover{background-color:var(--darkblue);transition-duration:.5s}.style-module--post--p5pPq button:active{position:relative;top:1px}</style><link rel="icon" href="/favicon-32x32.png?v=1dc09e9f9099aa4cad54b024844a081d" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=1dc09e9f9099aa4cad54b024844a081d"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=1dc09e9f9099aa4cad54b024844a081d"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=1dc09e9f9099aa4cad54b024844a081d"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=1dc09e9f9099aa4cad54b024844a081d"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=1dc09e9f9099aa4cad54b024844a081d"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=1dc09e9f9099aa4cad54b024844a081d"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=1dc09e9f9099aa4cad54b024844a081d"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=1dc09e9f9099aa4cad54b024844a081d"/><title data-react-helmet="true"></title></head><body><script>
void function() {
  window.__onThemeChange = function() {}

  var preferredTheme
  try {
    preferredTheme = localStorage.getItem('theme')
  } catch (err) { }

  function setTheme(newTheme) {
    if (preferredTheme && document.body.classList.contains(preferredTheme)) {
      document.body.classList.replace(preferredTheme, newTheme)
    } else {
      document.body.classList.add(newTheme)
    }

    window.__theme = newTheme
    preferredTheme = newTheme
    window.__onThemeChange(newTheme)
  }

  window.__setPreferredTheme = function(newTheme) {
    setTheme(newTheme)
    try {
      localStorage.setItem('theme', newTheme)
    } catch (err) {}
  }

  var darkQuery = window.matchMedia('(prefers-color-scheme: dark)')
  darkQuery.addListener(function(e) {
    window.__setPreferredTheme(e.matches ? 'dark' : 'light')
  })

  setTheme(preferredTheme || (darkQuery.matches ? 'dark' : 'light'))
}()
    </script><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><p>In the <a class="blueLink" href="/2019-06-17-circles-everywhere">previous blog post</a> I showed how to generate Scalable Vector Graphics (SVGs) of small circles packed inside a larger circle using JavaScript. In today&#x27;s post I&#x27;m packing circles inside a map of the UK and Ireland.</p><p>The first thing we will need is a black and white map of the UK and Ireland. This is surprisingly difficult to find online, but after some intense search engine work I was able to get one:</p><img style="width:100%;max-width:30rem" src="/static/UKAndIreland-10e38dab76cd45c144a37fbb0b69f0d2.png" alt="UK and Ireland"/><p>A black and white image allows us to easily check whether a pixel in the image is land (black) or sea (white), using its RGB(Red, Green, Blue) values. White, RGB(255, 255, 255), pixels will have an average RGB of 255 whereas black, RGB(0, 0, 0), pixels will have an average RGB of 0.</p><p>The majority of the code is much the same as <a class="blueLink" href="/2019-06-17-circles-everywhere">before</a>, we just need to change how the circles are placed:</p><pre><code class="language-javascript">const image = document.querySelector(&quot;#uk_and_ireland&quot;);
const LX = image.width;
const LY = image.height;
const canvas = figure.querySelector(&quot;canvas&quot;);
canvas.width = LX;
canvas.height = LY;
const ctx = canvas.getContext(&quot;2d&quot;);
ctx.drawImage(image, 0, 0);
const imageData = ctx.getImageData(0, 0, LX, LY).data;

function placeCircle(circles, radius, imageData, circleColours, LX, LY) {
  //The guard number: if we don&#x27;t place a circle within this number of trials, we give up.
  let guard = 500;
  while (guard &gt; 0) {
    // Pick a random position on the image.
    const cx = randomIntFromInterval(0, LX - 1);
    const cy = randomIntFromInterval(0, LY - 1);
    const index = (cx + cy * LX) * 4;
    const red = imageData[index + 0];
    const green = imageData[index + 1];
    const blue = imageData[index + 2];
    const average = (red + green + blue) / 3;
    const overlaps = circles.some(existingCircle =&gt;
      overlapWith(
        cx,
        cy,
        radius,
        existingCircle.cx,
        existingCircle.cy,
        existingCircle.r
      )
    );
    // The circle doesn&#x27;t overlap with any other circles and its in the dark image area.
    if (!overlaps &amp;&amp; average &lt; 255 / 2) {
      const circle = {
        cx: cx,
        cy: cy,
        r: radius,
        colour: circleColours[randomIntFromInterval(0, 3)],
      };
      circles.push(circle);
      return;
    }
    guard -= 1;
  }
}
</code></pre><p>We can use the half way point between 0 and 255 (128) to determine if a pixel is black or white. If the pixel is black and the circle doesn&#x27;t overlap with any of the others then we place it otherwise we find a different location on the image.</p><p>The finished result (with 3000 circle place attempts!) looks pretty good:</p><img style="width:100%;max-width:30rem" src="/static/UKAndIrelandCircles-0a478804265f2e7929d77e46199e55b3.png" alt="UK and Ireland Circles"/><p>Here&#x27;s a smaller interactive version, so you can make your own:</p><div><img class="style-module--displayBlock--F5TGV" src="/static/UKAndIrelandSmall-845f40a322bb455e59b94e66f49f65e0.png" alt="UK and Ireland"/><canvas class="style-module--displayNone--o8ClB"></canvas><div><div class="style-module--controlGroup--x616U"><input type="color" class="style-module--control--yfd3p" value="#993300"/><input type="color" class="style-module--control--yfd3p" value="#a5c916"/><input type="color" class="style-module--control--yfd3p" value="#00AA66"/><input type="color" class="style-module--control--yfd3p" value="#FF9900"/></div><div class="style-module--controlGroup--x616U"><label for="minRadius">Min radius:</label><input type="range" id="minRadius" class="style-module--control--yfd3p" step="0.25" min="2" max="5" value="2"/><span class="style-module--control--yfd3p">2</span></div><div class="style-module--controlGroup--x616U"><label for="maxRadius">Max radius:</label><input type="range" id="maxRadius" class="style-module--control--yfd3p" step="0.25" min="5" max="8" value="8"/><span class="style-module--control--yfd3p">8</span></div><button>Run</button></div></div><p>As always all of the code is available on my <a href="https://github.com/george-pearson" class="blueLink">GitHub</a>.</p></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/posts/2019-07-23-putting-svgs-on-the-map/";window.___webpackCompilationHash="0bdf0fa3582cf6e1d433";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-4bae0ebd19da6d624f9b.js"],"app":["/app-e18f485fa8c143d254d2.js"],"component---cache-caches-gatsby-plugin-offline-app-shell-js":["/component---cache-caches-gatsby-plugin-offline-app-shell-js-819fe14f87f7d11ff78a.js"],"component---src-pages-404-index-js":["/component---src-pages-404-index-js-97dbcd18b804de50e21f.js"],"component---src-pages-about-index-js":["/component---src-pages-about-index-js-c10abaf6c5813439682b.js"],"component---src-pages-photos-index-js":["/component---src-pages-photos-index-js-72b359f402934f472e95.js"],"component---src-pages-posts-2019-02-09-hello-world-index-mdx":["/component---src-pages-posts-2019-02-09-hello-world-index-mdx-5169a34f2ca3355f3389.js"],"component---src-pages-posts-2019-02-20-diamond-square-algorithm-cloud-images-index-mdx":["/component---src-pages-posts-2019-02-20-diamond-square-algorithm-cloud-images-index-mdx-7773e0541dda8104bd36.js"],"component---src-pages-posts-2019-03-06-svg-path-animations-index-mdx":["/component---src-pages-posts-2019-03-06-svg-path-animations-index-mdx-216ae0e3ebf9ba8766d6.js"],"component---src-pages-posts-2019-04-06-the-game-of-life-index-mdx":["/component---src-pages-posts-2019-04-06-the-game-of-life-index-mdx-a9fd88e12f4f1f578816.js"],"component---src-pages-posts-2019-05-19-sobel-index-mdx":["/component---src-pages-posts-2019-05-19-sobel-index-mdx-6cca229ebb5343e1db3e.js"],"component---src-pages-posts-2019-06-17-circles-everywhere-index-mdx":["/component---src-pages-posts-2019-06-17-circles-everywhere-index-mdx-1ef2077d55c89a27ea39.js"],"component---src-pages-posts-2019-07-23-putting-svgs-on-the-map-index-mdx":["/component---src-pages-posts-2019-07-23-putting-svgs-on-the-map-index-mdx-960e58e588323f175821.js"],"component---src-pages-posts-2019-08-11-moire-patterns-index-mdx":["/component---src-pages-posts-2019-08-11-moire-patterns-index-mdx-49ed069c34e1bb6fde55.js"],"component---src-pages-posts-2019-11-10-from-ruby-to-react-index-mdx":["/component---src-pages-posts-2019-11-10-from-ruby-to-react-index-mdx-1ff0f11276ea4758fd25.js"],"component---src-templates-post-list-template-post-list-template-js":["/component---src-templates-post-list-template-post-list-template-js-5a311f6487af04a6b7cc.js"],"component---src-templates-post-template-post-template-js":["/component---src-templates-post-template-post-template-js-4b6842084dc826fe5618.js"]};/*]]>*/</script><script src="/polyfill-4bae0ebd19da6d624f9b.js" nomodule=""></script><script src="/app-e18f485fa8c143d254d2.js" async=""></script><script src="/cb1608f2-3cf23382cb6f3aefd110.js" async=""></script><script src="/06fa0f4b-1a7e385b73cc8dc1f03a.js" async=""></script><script src="/795ab356-4ec0480de5c9f2ee0880.js" async=""></script><script src="/framework-f2034a9174dabc95a42e.js" async=""></script><script src="/webpack-runtime-601632c2be10b8e1ec20.js" async=""></script></body></html>